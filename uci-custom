#!/bin/sh

# 设置LAN接口IP地址为10.0.0.1
uci set network.lan.ipaddr='10.0.0.1'
uci set network.lan.netmask='255.255.255.0'

# 确保WAN口为eth1
uci set network.wan=interface
uci set network.wan.ifname='eth1'
uci set network.wan.proto='dhcp'

# 获取所有网络接口
interfaces=$(ls /sys/class/net/)

# 创建或清空LAN桥接接口列表
uci set network.lan.ifname=''

# 将除eth1外的所有以eth开头的接口添加到LAN桥接
for iface in $interfaces; do
    if [ "$iface" != "eth1" ] && [ "${iface:0:3}" = "eth" ]; then
        uci add_list network.lan.ifname="$iface"
    fi
done

# 提交更改
uci commit network

# 清理退出
exit 0
